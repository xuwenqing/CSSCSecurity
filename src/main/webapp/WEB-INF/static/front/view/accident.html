<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>案例分析管理</title>
		<link rel="shortcut icon" href="../images/logo.png" />
		<link type="text/css" href="../css/bootstrap.min.css" rel="stylesheet" />
		<link type="text/css" href="../css/common.css" rel="stylesheet" />
	</head>

	<body>
		<div class="header">
		<div class="container">
		<div class='row'>
			<div class='col-md-12'>
				<div class='row title'  >
					<div class='col-md-10 '>
						<h3 >中国船舶工业集团安全生产技术研究中心</h3>
						<p >SAFETY PRODUCTION TECHNOLOGY RESEARCH CENTER,CSSC</p>
					</div>
				</div>
				<div class='row'>
					<div class='col-md-12'>
						<nav class="navbar navbar-default" role="navigation">
							<div class="container-fluid">
								<div class="navbar-header">
									<a class="navbar-brand" href="./index.html">网站首页</a>
								</div>
								<div>
									<ul class="nav navbar-nav">
										<li >
											<a href="./standard.html">标准管理</a>
										</li>
										<li>
											<a href="./law.html">法律法规管理</a>
										</li>
										<li>
											<a href="./health.html">安全及职业健康知识管理</a>
										</li>
										<li>
											<a href="./frock.html">安全工装管理</a>
										</li>
										<li class="active">
											<a href="./accident.html">案例分析管理</a>
										</li>
										<li>
											<a href="./technique.html">国内外新技术管理</a>
										</li>
										<li>
											<a href="#">联系我们</a>
										</li>
									</ul>
								</div>
							</div>
						</nav>
					</div>
				</div>
			</div>
		</div>
		</div>
	</div>
		<div class="container" id="MainView"></div>
		<script type="text/template" id="MainView-template">
			<div class="row-content" style="margin-left: 2px;margin-top:0px;width:1140px; ">

				<div id="carouselcontainter" class="carousel" data-ride="carousel" style="width:1140px; height:270px;">
					<ol class="carousel-indicators">
						<li class="active" data-target="#carouselcontainter" data-slide-to="0">

						</li>
						<li  data-target="#carouselcontainter" data-slide-to="1">

						</li>
						<li  data-target="#carouselcontainter" data-slide-to="2">

						</li>
						<li  data-target="#carouselcontainter" data-slide-to="3">

						</li>
					</ol>
					<div class="carousel-inner" style="width:1140px;height:270px; ">
						<div class="item active" style="width:1140px;height:270px; ">
							<img src=" ../images/image1.jpg" alt="图片"width=“1140”;height=“270” >
						</div>
						<div class="item">
							<img src="../images/image2.JPG"  alt="图片" width="1140" height="270" >
						</div>
						<div class="item">
							<img src="../images/image3.jpg"  alt="图片" width="1140" height="270" >
						</div>
						<div class="item">
							<img src="../images/image4.png"  alt="图片" width="1140" height="270" >
						</div>
					</div>
				</div>
			</div>
			<div class="row-content">
				<div class="col-xs-3"  style="background: #ffffff;">
					<div class="Content-search" style="margin-left: 0;">
						<h4 class="list-group-item active" style="margin-top: 0;">站内搜索</h4>
						<form class="form-horizontal"  >
							<select class="form-control" name="condition">
								<option value="name" >标题</option>
								<option value="category">所属类别</option>
								<option value="keywords">关键词</option>
							</select>
							<div class="form-group" style="padding-right:0;margin-left: 0;margin-right: 0;margin-bottom: 0;">
								<div class="col-xs-8" style="padding-left: 0;margin-top: 4px;">
									<input class="form-control" type="text" placeholder="请输入查询条件" />
								</div>
								<div class="col-xs-3" style="padding-right:0;margin-top:4px;float:right;" >
									<button type="button" class=" btn btn-info js-search " style="float: right;">搜素</button>
								</div>
							</div>
						</form>
					</div>
					<div class="Menu-item">
						<h4 class="list-group-item active">案例分析</h4>
						<ul class="list-group">
							<li class="list-group-item ">
								<a href="javascript:void(0);" class="js-category" title="物体打击事故">
									物体打击事故
								</a>
							</li>
							<li class="list-group-item ">
								<a href="javascript:void(0);" class="js-category" title="起重伤害事故">
									起重伤害事故
								</a>
							</li>
							<li class="list-group-item">
								<a href="javascript:void(0);" class="js-category" title="火灾爆炸窒息事故">
									火灾爆炸窒息事故
								</a>
							</li>
							<li class="list-group-item">
								<a href="javascript:void(0);" class="js-category" title="高处坠落事故">
									高处坠落事故
								</a>
							</li>
							<li class="list-group-item">
								<a href="javascript:void(0);" class="js-category" title="触电事故">
									触电事故
								</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-xs-9" style="background: #ffffff;">
					<div class="row" style="background: #fbfbfb;">
						<div class="col-xs-3" style="border-bottom:2px solid crimson;">
							<h4 >案例分析</h4>
						</div>
						<div class=" pull-right" style="padding-top:10px;padding-right:12px;">
							当前位置：<a href="../view/index.html" title="网站首页">网站首页</a> &gt; <a href="#" >案例分析管理</a>&gt;> 案例分析

						</div>
					</div>
					<div class="row" id="accidentListView">
					</div>
					<div id="flip">
						<div class='digg4 metpager_8'>
							<span class='disabled disabledfy'><b>«</b></span>
							<span class='disabled disabledfy'>‹</span>
							<span class='current'>1</span>
							<span class='disabled disabledfy'>›</span>
							<span class='disabled disabledfy'><b>»</b></span>
						</div>
					</div>
				</div>
			</div>
		</script>

		<!--案例分析视图-->
		<script type="text/template" id="accidentListView-template">

		</script>

		<script type="text/template" id="accidentView-template">
			<div class="row">
				<div class="col-xs-7">
					<a href="javascript:void(0);" class="js-detail">
						<%= name %>
					</a>
				</div>
				<div class="col-xs-2 col-xs-offset-3">
					<span>【<%= this.Timer(publishDate) %>】</span>
				</div>
			</div>

		</script>

	</body>
	<script src="../js/jquery-1.9.1.min.js" type="text/javascript"></script>
	<script src="../js/moment.js" type="text/javascript"></script>
	<script src="../js/jquery.json.js" type="text/javascript"></script>
	<script src="../js/Underscore.js" type="text/javascript"></script>
	<script src="../js/Backbone.js" type="text/javascript"></script>
	<script src="../js/backbone.layoutmanager.js" type="text/javascript"></script>
	<script src="../js/moment.js" type="text/javascript"></script>
	<script type="text/javascript" src="../entities/entities.js"></script>
	<script type="text/javascript" src="../handle/accident/accident.js"></script>
	<script type="text/javascript"  src="../js/bootstrap-carousel.js"></script>
	<script>
		!function ($) {
			$(function(){

				$('#carouselcontainter').carousel()
			})
		}(window.jQuery)
	</script>


	<script type="text/javascript">
		(function(Backbone, _) {
			var EventBus = _.extend({}, Backbone.Events);
			var AccidentCollection = Entities.Accident.Collection;
					var Url = Entities.config.apiUrl;
			Backbone.Layout.configure({
				manage: true
			});

			//案例分析视图
			var AccidentView = Backbone.View.extend({
				template: '#accidentView-template',
				tagName: 'li',
				className: 'list-group-item',
				events: {
					'click .js-detail': '_onShowDetail'
				},
				_onShowDetail: function() {
					var m_id = this.model.id;
					var location = Url + "/front/detail/accidentDetail.html?id=" + m_id;
					window.open(location);
				},
				Timer: function(time) {
					return moment(time).format('YYYY-MM-DD');
				}
			});
			//案例分析列表视图
			var AccidentListView = Backbone.View.extend({
				template: '#accidentListView-template',
				tagName: 'ul',
				className: 'list-group',
				initialize: function() {
					this.listenTo(this.collection, 'reset', this.addAll);
					this.listenTo(EventBus, 'accident:show', this._onAccidentShow);
					this.listenTo(EventBus, 'category:show', this._onCategoryShow);
					this.onCreate();
				},
				addOne: function(AccidentModel) {
					var accidentView = new AccidentView({
						model: AccidentModel
					});
					this.insertView('', accidentView).render();
				},
				addAll: function() {
					this.render();
					this.collection.each(this.addOne, this);
				},
				_onAccidentShow: function(condition) {
					this.collection.fetch(condition);
				},
				_onCategoryShow: function(cate) {
					this.collection.fetch({
						category: cate
					});
				},
				onCreate: function() {
					this.collection.fetch();
				}
			});

			var MainView = Backbone.View.extend({
				template: '#MainView-template',
				events: {
					'click .js-search': '_onShowInfo',
					'click .js-category': '_onShowCategory'
				},
				beforeRender: function() {
					this.accidentListView = new AccidentListView({
						collection: new AccidentCollection()
					});
					this.setView('#accidentListView', this.accidentListView);
				},
				_onShowInfo: function() {
					var key = $('select').val();
					var value = $("input").val();
					var data = {};
					if(key && value) {
						data[key] = value;
						EventBus.trigger('accident:show', data);
					}
				},
				_onShowCategory: function(ctx) {
					var cate = $(ctx.target).attr('title');
					EventBus.trigger('category:show', cate);
				}
			});
			new MainView({
				el: '#MainView'
			}).render();
		})(Backbone, _);
	</script>

</html>